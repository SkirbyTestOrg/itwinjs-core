# Making changes to the ECPresentation library

Below are instructions for library developers on how to commit, push and
publish changes to the library.

## Changing dependency package versions

After changing dependency package versions make sure you
call `rush check` to verify versions match all throughout the
repository. Failure to do so might cause different packages in the
repository to use different versions of the same packages, thus resulting
in hard to diagnose issues.

## Committing changes

It's important to generate change files when committing changes -
steps #2 - #5 do that.

1. Commit some changes.

2. `rush change` asks several questions about the changes and creates change files.

3. Review the change files created by Rush.

4. `git add .` stages created change files for commit.

5. `git commit --amend --no-edit` amends the generated change files to the last commit.

You can make multiple local commits before pushing the changes.

### Why is that important?

For several reasons:
1. You don't need to increase the package version after each commit
2. You don't need to remember what kind of changes (major, minor, patch)
were made in all the commits since last publish when you're updating
package versions before publishing.
3. It creates a nice *CHANGELOG.md* file which can be used as a reference
to see what changes were made in each package version.

## Pushing the changes

Use [pull requests](./PULL_REQUESTS.md).

Note: before pushing it's recommended to run the `scripts/pre-publish.bat`
file - it runs the same commands as our CI job and helps to make
sure you don't forget to build / lint / test / etc.

## Publishing changes

New version of the library should be published when it reaches some
milestone. When it does, the following steps should be taken to publish
new versions:

1. `rush publish -a`

   The command does several things:
   - Generates changelogs based on change files (generated by `rush change`)
   - Increases library package versions. The new versions depend on the
   answers to `rush change` questions.
   - Updates library package dependency versions for *sample* and *test*
   packages.

2. Review the changes made by Rush and make appropriate changes, if necessary.
*CHANGELOG.md* files can be regenerated after changing *CHANGELOG.json* with a
rush command `rush publish --regenerate-changelogs`.

3. `git add .`

4. `git commit -m "Applying package updates."`

5. `git push`

6. The `ecpresentation` CI job is automatically started. Open the job and tag it
with a "Release" tag. This will start a release job after a successful build which
will publish the packages.
